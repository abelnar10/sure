<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora</title>
    <style>
        /* Diseño general de la calculadora */
        .calculator {
            max-width: 90%; /* Ajuste automático al ancho */
            margin: 20px auto;
            padding: 20px;
            background-color: #f0f0f0;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }

        /* Pantalla de visualización */
        #display {
            width: 100%;
            height: 60px;
            font-size: 2rem;
            text-align: right;
            padding: 10px;
            box-sizing: border-box;
            border-radius: 8px;
            margin-bottom: 10px;
        }

        /* Contenedor de botones */
        .buttons {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
        }

        /* Botones */
        button {
            padding: 20px;
            font-size: 1.5rem;
            border: none;
            background-color: #fff;
            cursor: pointer;
            border-radius: 8px;
            transition: background-color 0.3s;
        }

        button:hover {
            background-color: #e0e0e0;
        }

        /* Botones especiales */
        .divide {
            background-color: #4CAF50;
            color: white;
        }

        .equals {
            background-color: #2196F3;
            color: white;
            grid-column: span 2; /* El botón "=" ocupa dos columnas */
        }

        .clear {
            background-color: #FF5722;
            color: white;
        }

        /* Estilo del select de moneda */
        #currencySelect {
            width: 100%;
            padding: 12px;
            margin-bottom: 15px;
            font-size: 1rem;
            border-radius: 8px;
        }

        /* Resultado de la conversión */
        .results {
            margin-top: 20px;
            padding: 10px;
            background-color: #fff;
            border-radius: 8px;
        }

        #realValue {
            font-size: 0.9rem;
            color: #666;
            margin-top: 10px;
            text-align: right;
        }

    </style>
</head>
<body>
    <div class="calculator">
        <select id="currencySelect">
            <option value="COP">Peso Colombiano</option>
            <option value="EUR">Euro</option>
            <option value="USD">Dólar</option>
        </select>
        <input type="text" id="display" readonly>
        <div id="realValue"></div>
        <div class="buttons">
            <button onclick="addNumber('7')">7</button>
            <button onclick="addNumber('8')">8</button>
            <button onclick="addNumber('9')">9</button>
            <button onclick="clearDisplay()" class="clear">C</button>
            <button onclick="addNumber('4')">4</button>
            <button onclick="addNumber('5')">5</button>
            <button onclick="addNumber('6')">6</button>
            <button onclick="divide()" class="divide">÷</button>
            <button onclick="addNumber('1')">1</button>
            <button onclick="addNumber('2')">2</button>
            <button onclick="addNumber('3')">3</button>
            <button onclick="addNumber('0')">0</button>
            <button onclick="addNumber('.')">.</button>
            <button onclick="calculate()" class="equals">=</button>
        </div>
        <div class="results">
            <p>Resultado en:</p>
            <div id="copResult">COP: </div>
            <div id="usdResult">USD: </div>
            <div id="eurResult">EUR: </div>
        </div>
    </div>

    <script>
        let currentNumber = '';
        let firstNumber = null;
        let awaitingSecondNumber = false;
        let operationPending = false;

        // Tasas de cambio
        const exchangeRates = {
            COP: 1,
            USD: 0.00022, // 1 COP = 0.00025 USD
            EUR: 0.00021  // 1 COP = 0.00023 EUR
        };

        function addNumber(num) {
            if (awaitingSecondNumber) {
                currentNumber = num;
                awaitingSecondNumber = false;
            } else {
                currentNumber += num;
            }
            updateDisplay();
        }

        function getAdjustedValue(value) {
            const selectedCurrency = document.getElementById('currencySelect').value;
            if (selectedCurrency === 'COP' && !value.includes('.')) {
                return parseFloat(value) * 1000;
            }
            return parseFloat(value);
        }

        function updateDisplay() {
            document.getElementById('display').value = currentNumber;
            
            // Mostrar el valor real para COP
            const selectedCurrency = document.getElementById('currencySelect').value;
            if (selectedCurrency === 'COP' && currentNumber && !currentNumber.includes('.')) {
                document.getElementById('realValue').textContent = 
                    `Valor a operar: ${(parseFloat(currentNumber) * 1000).toLocaleString()}`;
            } else {
                document.getElementById('realValue').textContent = '';
            }
        }

        function clearDisplay() {
            currentNumber = '';
            firstNumber = null;
            awaitingSecondNumber = false;
            operationPending = false;
            updateDisplay();
            updateResults(0);
        }

        function divide() {
            if (firstNumber === null && currentNumber !== '') {
                firstNumber = getAdjustedValue(currentNumber);
                awaitingSecondNumber = true;
                operationPending = true;
                currentNumber = '';
            }
        }

        function calculate() {
            if (operationPending && currentNumber !== '') {
                const secondNumber = getAdjustedValue(currentNumber);
                if (secondNumber === 0) {
                    alert('No se puede dividir por cero');
                    return;
                }
                
                const result = firstNumber / secondNumber;
                const selectedCurrency = document.getElementById('currencySelect').value;
                
                // El resultado ya está en la moneda seleccionada
                let resultInCOP;
                if (selectedCurrency === 'COP') {
                    resultInCOP = result;
                } else if (selectedCurrency === 'USD') {
                    resultInCOP = result / exchangeRates.USD;
                } else if (selectedCurrency === 'EUR') {
                    resultInCOP = result / exchangeRates.EUR;
                }

                updateResults(resultInCOP);
                
                currentNumber = result.toFixed(2);
                firstNumber = null;
                operationPending = false;
                updateDisplay();
            }
        }

        function updateResults(amountInCOP) {
            document.getElementById('copResult').textContent = 
                `COP: ${amountInCOP.toFixed(2)}`;
            document.getElementById('usdResult').textContent = 
                `USD: ${(amountInCOP * exchangeRates.USD).toFixed(2)}`;
            document.getElementById('eurResult').textContent = 
                `EUR: ${(amountInCOP * exchangeRates.EUR).toFixed(2)}`;
        }
    </script>
</body>
</html>
